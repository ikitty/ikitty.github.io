<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="utf-8" />
<title>Demo by Alextang</title>
<style type="text/css">
    * {margin:0; padding:0; list-style:none; }
    body {font:normal 12px/30px Verdana;padding: 20px;background-color: #FFF;tac }
    
    textarea {margin-top: 10px;width: 700px;height: 300px;border: 1px solid #999;}
    #box {margin: 10px;width: 200px;height: 100px;background-color: #F90;}
</style>

</head>
<body>

<input type="button" id="btn" value="read excel" onclick="getTopCate()" /><br />
<textarea id="result"></textarea>

<div id="box">
   
</div>

<script type="text/javascript">
    var read = new readExcel() ;

    var oXL = new ActiveXObject("Excel.application"); //创建Excel.Application对象
    var bk = oXL.Workbooks ;
    var oWB = oXL.Workbooks.open('D:\test.xls');
    // it doesnot work in win8 
    //bye
    // alert(oWB);

    var CLASS = {
        create: function () {
            return function () {
                this.init.apply(this, arguments);
            } ;
        }
    } ;

    var readExcel = CLASS.create() ;
    readExcel.prototype = {
        init: function () {
            this.obj = false ;
        },
        open: function (filepath) {
            this.obj = new ActiveXObject("Excel.Application");
            try{
                this.obj.wb = this.obj.Workbooks.open(filepath);
                alert(this.obj.wb);
                this.obj.sheet = this.obj.wb.Worksheets;
                this.obj.cell = this.obj.sheet(1).Cells;
                //ActiveSheet == Worksheets(1)
                //oSheet.usedrange.rows.count
            }catch(e){
                alert('load excelFile failure');
            }
        },
        close: function () {
            this.obj.cell = null ;
            this.obj.sheet = null ;
            this.obj.wb.close();
            this.obj = null ;
        }
    } ;

    

    // expand method
    read.getData = function () {
        this.obj.result = '' ;
        var c = this.obj.cell;
        for (var i = 2, le = 5; i < le; i++ ) {
            alert(c(i,1).value);
            this.obj.result += this.formatData(this.obj.cell(i,1).value, this.obj.cell(i,2).value);
        }
        get('result').value = this.obj.result ;
        alert(1);
    } ;
    read.formatData = function (title, href) {
        return '<li><a href="http://'+ href +'">' + title + '</a></li>\n\r' ;
    } ;
    window.onload = function () {
        read.open('D:/test.xls');
        read.getData();
    }

</script>
</body>
</html>
